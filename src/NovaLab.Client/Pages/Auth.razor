@page "/Auth"
@using Microsoft.AspNetCore.Authorization
@using System.Security.Claims
@using NovaLab.Client.Lib.Components.NovaLabApi

@layout MainLayout

@attribute [Authorize, StreamRendering]

@inject AuthenticationStateProvider AuthenticationStateProvider

<h3>Auth</h3>

<AuthorizeView>
    @* <p>Welcome, @(Claims?.Identity?.Name ?? "")</p> *@
    <FormTrackedStreamSubjectNew/>
    <TrackedStreamSubjectSelector/>
</AuthorizeView>

@code {
    private ClaimsPrincipal? Claims { get; set; }
    
    protected override async Task OnInitializedAsync() {
        await base.OnInitializedAsync();
        
        AuthenticationState authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        Claims = authState.User;
    }
}