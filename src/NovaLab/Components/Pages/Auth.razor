@page "/auth"
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Identity
@using NovaLab.Data
@using TwitchLib.Api
@using NovaLab.RazorComponents
@inject TwitchAPI TwitchApi
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject UserManager<ApplicationUser> UserManager

@rendermode InteractiveServer

@attribute [Authorize, StreamRendering]

<PageTitle>Auth</PageTitle>

<h1>You are authenticated</h1>

<AuthorizeView>
    Hello @context.User.Identity?.Name!
    id:@(context.User.FindFirst(u => u.Type.Contains("nameidentifier"))!.Value)
    
    <BtnGetTwitchRedemption UserId="@(context.User.FindFirst(u => u.Type.Contains("nameidentifier"))!.Value)"/>
    
</AuthorizeView>

@code {
    protected override async Task OnInitializedAsync() {
        await Task.Delay(500);
    }

}
